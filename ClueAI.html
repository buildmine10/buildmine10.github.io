<!DOCTYPE html>
<html>


<style>
    body {
        font-size: larger;
        display: flex;
        flex-direction: column;
        align-items: stretch;
        background-color: lightgrey;
    }


    #infoGridDiv {
        background-color: grey;
        display: flex;
        gap: 0.25em;
        padding: 0.5em;
        box-sizing: border-box;
        
    }

    .infoGridColumn {
        display: flex;
        flex-direction: column;
        gap: 0.25em;
        justify-content: space-around;
    }

    .infoGridEntry {
        background-color: white;
        padding: 0.5em;
    }

    #top{
        display: flex;
        flex-direction: row;
    }

    #bottom{
        display: flex;
        flex-direction: row;
        background-color: pink;
    }

    #topRight{
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        margin: 1em;
        gap: 1em;
    }

    #characterGuessSelector{
        display: flex;
        flex-direction: column;
        padding: 1em;
        gap: 1em;
    }

    .radioButtonLabel{
        background-color: darkgrey;
        padding: 0.75em;
        text-align: center;
    }

    input[type=radio]:checked+.radioButtonLabel{
        background-color: lightblue;
    }

    input[type=radio]:hover+.radioButtonLabel{
        background-color: lightslategrey;
    }

    input[type=radio]{
        display: none;
    }
    

    #weaponGuessSelector{
        display: flex;
        flex-direction: column;
        padding: 1em;
        gap: 1em;
    }

    #roomGuessSelector{
        display: flex;
        flex-direction: column;
        padding: 1em;
        gap: 1em;
    }

    #topRightTop{
        display: flex;
        justify-content: space-around;
    }


    .ColumnLabel{
        background-color: darkgrey;
        text-align: center;
        padding: 1em;
        border-bottom: 2px solid black;
    }


    button{
        padding: 1em;
        font-size: larger;
    }

    input[type=number]{
        font-size: larger;
    }

    #askingPlayerGuessDiv{
        background-color: darkgrey;
        display: flex;
        flex-direction: column;
        gap: 0.5em;
        padding: 0.5em;
    }

    #answeringPlayerGuessDiv{
        background-color: darkgrey;
        display: flex;
        flex-direction: column;
        gap: 0.5em;
        padding: 0.5em;
    }
    
</style>

<body>
    <div id="top">
        <div id="infoGridDiv">
        </div>
        <div id=topRight>
            <div id="topRightTop">
                <div id="characterGuessSelector">
                    <div class="ColumnLabel">
                        Character
                    </div>

                    <input type="radio" name="guessCharacter" value="Miss Scarlett" id="Miss Scarlett Guess">
                    <label class="radioButtonLabel" for="Miss Scarlett Guess">Miss Scarlett</label>
    
                    <input type="radio" name="guessCharacter" value="Mr. Green" id="Mr. Green Guess">
                    <label class="radioButtonLabel" for="Mr. Green Guess">Mr. Green</label>
    
                    <input type="radio" name="guessCharacter" value="Col. Mustard" id="Col. Mustard Guess">
                    <label class="radioButtonLabel" for="Col. Mustard Guess">Col. Mustard</label>
    
                    <input type="radio" name="guessCharacter" value="Prof. Plum" id="Prof. Plum Guess">
                    <label class="radioButtonLabel" for="Prof. Plum Guess">Prof. Plum</label>
    
                    <input type="radio" name="guessCharacter" value="Mrs. Peacock" id="Mrs. Peacock Guess">
                    <label class="radioButtonLabel" for="Mrs. Peacock Guess">Mrs. Peacock</label>
    
                    <input type="radio" name="guessCharacter" value="Mrs. White" id="Mrs. White Guess">
                    <label class="radioButtonLabel" for="Mrs. White Guess">Mrs. White</label>

                    <div id="askingPlayerGuessDiv">
                        Asking Player
                        <input type="number" id="askingPlayerGuess" min="0" max="5" value="0">
                    </div>
                    
                </div>
    
                <div id="weaponGuessSelector">
                    <div  class="ColumnLabel">
                        Weapon
                    </div>

                    <input type="radio" name="guessWeapon" value="Candlestick" id="Candlestick Guess">
                    <label class="radioButtonLabel" for="Candlestick Guess">Candlestick</label>
    
                    <input type="radio" name="guessWeapon" value="Dagger" id="Dagger Guess">
                    <label class="radioButtonLabel" for="Dagger Guess">Dagger</label>
    
                    <input type="radio" name="guessWeapon" value="Lead Pipe" id="Lead Pipe Guess">
                    <label class="radioButtonLabel" for="Lead Pipe Guess">Lead Pipe</label>
    
                    <input type="radio" name="guessWeapon" value="Revolver" id="Revolver Guess">
                    <label class="radioButtonLabel" for="Revolver Guess">Revolver</label>
    
                    <input type="radio" name="guessWeapon" value="Rope" id="Rope Guess">
                    <label class="radioButtonLabel" for="Rope Guess">Rope</label>
    
                    <input type="radio" name="guessWeapon" value="Wrench" id="Wrench Guess">
                    <label class="radioButtonLabel" for="Wrench Guess">Wrench</label>

                    <div id="answeringPlayerGuessDiv">
                        Answering Player
                        <input type="number" id="answeringPlayerGuess" min="0" max="5" value=0>
                    </div>
                </div>
    
                <div id="roomGuessSelector">
                    <div  class="ColumnLabel">
                        Room
                    </div>

                    <input type="radio" name="guessRoom" value="Kitchen" id="Kitchen Guess">
                    <label class="radioButtonLabel" for="Kitchen Guess">Kitchen</label>
    
                    <input type="radio" name="guessRoom" value="Ball Room" id="Ball Room Guess">
                    <label class="radioButtonLabel" for="Ball Room Guess">Ball Room</label>
    
                    <input type="radio" name="guessRoom" value="Conservatory" id="Conservatory Guess">
                    <label class="radioButtonLabel" for="Conservatory Guess">Conservatory</label>
    
                    <input type="radio" name="guessRoom" value="Dining Room" id="Dining Room Guess">
                    <label class="radioButtonLabel" for="Dining Room Guess">Dining Room</label>
    
                    <input type="radio" name="guessRoom" value="Billard Room" id="Billard Room Guess">
                    <label class="radioButtonLabel" for="Billard Room Guess">Billard Room</label>
    
                    <input type="radio" name="guessRoom" value="Library" id="Library Guess">
                    <label class="radioButtonLabel" for="Library Guess">Library</label>
    
                    <input type="radio" name="guessRoom" value="Lounge" id="Lounge Guess">
                    <label class="radioButtonLabel" for="Lounge Guess">Lounge</label>
    
                    <input type="radio" name="guessRoom" value="Hall" id="Hall Guess">
                    <label class="radioButtonLabel" for="Hall Guess">Hall</label>
    
                    <input type="radio" name="guessRoom" value="Study" id="Study Guess">
                    <label class="radioButtonLabel" for="Study Guess">Study</label>
                </div>
            </div>
            <button onclick="clearGuessSelection()">Clear Selection</button>
            <button onclick="submitGuess()">Submit Guess</button>
            <button onclick="addToYourCards()">Add To Your Cards</button>
        </div>
    </div>
    <div id="bottom">  
        <button onclick="testFunction()">test button</button>
    </div>

</body>


<script>
    //6 characters
    //6 weapons
    //9 rooms

    const validCharacters = ["Miss Scarlett", "Mr. Green", "Col. Mustard", "Prof. Plum", "Mrs. Peacock", "Mrs. White"];
    const validWeapons = ["Candlestick", "Dagger", "Lead Pipe", "Revolver", "Rope", "Wrench"];
    const validRooms = ["Kitchen", "Ball Room", "Conservatory", "Dining Room", "Billard Room", "Library", "Lounge", "Hall", "Study"];

    const indexToCharacterName = new Map();
    {
        indexToCharacterName.set(0, "Miss Scarlett");
        indexToCharacterName.set(1, "Mr. Green");
        indexToCharacterName.set(2, "Col. Mustard");
        indexToCharacterName.set(3, "Prof. Plum");
        indexToCharacterName.set(4, "Mrs. Peacock");
        indexToCharacterName.set(5, "Mrs. White");
    }
    

    const indexToWeaponName = new Map();
    {
        indexToWeaponName.set(0, "Candlestick");
        indexToWeaponName.set(1, "Dagger");
        indexToWeaponName.set(2, "Lead Pipe");
        indexToWeaponName.set(3, "Revolver");
        indexToWeaponName.set(4, "Rope");
        indexToWeaponName.set(5, "Wrench");
    }
    


    const indexToRoomName = new Map();
    {
        indexToRoomName.set(0, "Kitchen");
        indexToRoomName.set(1, "Ball Room");
        indexToRoomName.set(2, "Conservatory");
        indexToRoomName.set(3, "Dining Room");
        indexToRoomName.set(4, "Billard Room");
        indexToRoomName.set(5, "Library");
        indexToRoomName.set(6, "Lounge");
        indexToRoomName.set(7, "Hall");
        indexToRoomName.set(8, "Study");
    }
    

    var numberOfPlayers = 6;


    //Set up the cards
    //0 = no info
    //1 = might have the card
    //2 = has the card
    //-1 = doesn't have the card

    var characterCards = [];//[playerIndex][characterName]
    for (let i = 0; i < numberOfPlayers; i++) {
        characterCards.push(new Map());
        //0 = no info
        //1 = might have the card
        //2 = has the card
        //-1 = doesn't have the card
        characterCards[characterCards.length - 1].set("Miss Scarlett", 0);
        characterCards[characterCards.length - 1].set("Mr. Green", 0);
        characterCards[characterCards.length - 1].set("Col. Mustard", 0);
        characterCards[characterCards.length - 1].set("Prof. Plum", 0);
        characterCards[characterCards.length - 1].set("Mrs. Peacock", 0);
        characterCards[characterCards.length - 1].set("Mrs. White", 0);
    }


    var weaponCards = [];//[playerIndex][weaponName]
    for (let i = 0; i < numberOfPlayers; i++) {
        weaponCards.push(new Map());
        //0 = no info
        //1 = might have the card
        //2 = has the card
        //-1 = doesn't have the card
        weaponCards[weaponCards.length - 1].set("Candlestick", 0);
        weaponCards[weaponCards.length - 1].set("Dagger"    , 0);
        weaponCards[weaponCards.length - 1].set("Lead Pipe" , 0);
        weaponCards[weaponCards.length - 1].set("Revolver"  , 0);
        weaponCards[weaponCards.length - 1].set("Rope"      , 0);
        weaponCards[weaponCards.length - 1].set("Wrench"    , 0);
    }
    

    var roomCards = [];//[playerIndex][roomName]
    for (let i = 0; i < numberOfPlayers; i++) {
        roomCards.push(new Map());
        //0 = no info
        //1 = might have the card
        //2 = has the card
        //-1 = doesn't have the card
        roomCards[roomCards.length - 1].set("Kitchen"       , 0);
        roomCards[roomCards.length - 1].set("Ball Room"     , 0);
        roomCards[roomCards.length - 1].set("Conservatory"  , 0);
        roomCards[roomCards.length - 1].set("Dining Room"   , 0);
        roomCards[roomCards.length - 1].set("Billard Room"  , 0);
        roomCards[roomCards.length - 1].set("Library"       , 0);
        roomCards[roomCards.length - 1].set("Lounge"        , 0);
        roomCards[roomCards.length - 1].set("Hall"          , 0);
        roomCards[roomCards.length - 1].set("Study"         , 0);
    }

       
    //End of card setup

    //Finds the maximum value in the characterCards array for a specific character
    //2 = this character is not guilty
    //1 = this character might not be guilty
    //0 = no info
    //-1 = guilty
    //Anything else = something went wrong
    function checkCharacterScore(characterName) {
        let out = -Infinity;
        for (let i = 0; i < characterCards.length; i++) {
            let value = characterCards[i].get(characterName);
            if (value == undefined) {
                return "Invalid Name";//Invalid character name
            }
            if (value > out) {
                out = value;
            }
        }

        return out;
    }

    function checkWeaponScore(weaponName) {
        let out = -Infinity;
        for (let i = 0; i < weaponCards.length; i++) {
            let value = weaponCards[i].get(weaponName);
            if (value == undefined) {
                return "Invalid Name";//Invalid weapon name
            }
            if (value > out) {
                out = value;
            }
        }

        return out;
    }

    function checkRoomScore(roomName) {
        let out = -Infinity;
        for (let i = 0; i < roomCards.length; i++) {
            let value = roomCards[i].get(roomName);
            if (value == undefined) {
                return "Invalid Name";//Invalid room name
            }
            if (value > out) {
                out = value;
            }
        }

        return out;
    }


    class Guess {
        constructor(character, weapon, room) {
            if(validCharacters.includes(character)){
                this.character = character;
            }else{
                throw "Invalid character name in Guess";
            }
        
            if(validWeapons.includes(weapon)){
                this.weapon = weapon;
            }else{
                throw "Invalid weapon name in Guess";
            }

            if(validRooms.includes(room)){
                this.room = room;
            }else{
                throw "Invalid room name in Guess";
            }
            
        }
    }

    function applyGuessResult(askingPlayer, answeringPlayer, guess) {
        if (answeringPlayer <= askingPlayer) {
            answeringPlayer += numberOfPlayers;
        }

        //This is where we determine who does not have specific cards
        //It starts just after the asking player and ends just before the answering player
        for (var i = askingPlayer + 1; i < answeringPlayer; i++) {
            characterCards[i % numberOfPlayers].set(guess.character, -1);
            weaponCards[i % numberOfPlayers].set(guess.weapon, -1);
            roomCards[i % numberOfPlayers].set(guess.room, -1);
        }




        //For each of the cards that were guessed.
        //If the answering player doesn't have the card, don't set the state to 1 (meaning that they might have the card)
        //If the answering player definitly has the card, don't set the state to 1 (meaning that they might have the card)
        //This will alter the state of the data in a way that increases the informaion available

        answerPlayerCharacter = characterCards[answeringPlayer % numberOfPlayers].get(guess.character);
        if (answerPlayerCharacter != -1 && answerPlayerCharacter != 2) {
            characterCards[answeringPlayer % numberOfPlayers].set(guess.character, 1);
        }


        answerPlayerWeapon = weaponCards[answeringPlayer % numberOfPlayers].get(guess.weapon);
        if (answerPlayerWeapon != -1 && answerPlayerWeapon != 2) {
            weaponCards[answeringPlayer % numberOfPlayers].set(guess.weapon, 1);
        }

        answerPlayerRoom = roomCards[answeringPlayer % numberOfPlayers].get(guess.room);
        if (answerPlayerRoom != -1 && answerPlayerRoom != 2) {
            roomCards[answeringPlayer % numberOfPlayers].set(guess.room, 1);
        }


        //The only way to confirm if someone has a card is to ask about it, and get it shown
    }

    function updateDataGrid() {
        let infoGrid = document.getElementById("infoGridDiv");
        infoGrid.innerHTML = "";


        //The Labels
        let labelDiv = document.createElement("div");
        labelDiv.className = "infoGridColumn";
        for(let i = 0; i < 6; i++){
            let div = document.createElement("div");
            div.className = "infoGridEntry"
            div.innerText = indexToCharacterName.get(i);
            labelDiv.appendChild(div);
        }

        labelDiv.appendChild(document.createElement("br"));
        for(let i = 0; i < 6; i++){
            let div = document.createElement("div");
            div.className = "infoGridEntry"
            div.innerText = indexToWeaponName.get(i);
            labelDiv.appendChild(div);
        }

        labelDiv.appendChild(document.createElement("br"));
        for(let i = 0; i < 9; i++){
            let div = document.createElement("div");
            div.className = "infoGridEntry"
            div.innerText = indexToRoomName.get(i);
            labelDiv.appendChild(div);
        }
        infoGrid.appendChild(labelDiv);

        //The data
        for(let i = 0; i < numberOfPlayers; i++){
            //console.log("hi")
            infoGrid.appendChild(generateDataColumn(i));
        }
    }

    function generateDataColumn(playerIndex) {
        let out = document.createElement("div");
        out.className = "infoGridColumn";

        //Characters
        for (let i = 0; i < 6; i++) {
            let entry = document.createElement("div");
            entry.className = "infoGridEntry";
            
            entry.innerText = characterCards[playerIndex].get(indexToCharacterName.get(i));
            out.appendChild(entry);
        }

        out.appendChild(document.createElement("br"));

        //Weapons
        for (let i = 0; i < 6; i++) {
            let entry = document.createElement("div");
            entry.className = "infoGridEntry";

            entry.innerText = weaponCards[playerIndex].get(indexToWeaponName.get(i));
            out.appendChild(entry);
        }

        
        out.appendChild(document.createElement("br"));

        //rooms
        for (let i = 0; i < 9; i++) {
            let entry = document.createElement("div");
            entry.className = "infoGridEntry";
            
            entry.innerText = roomCards[playerIndex].get(indexToRoomName.get(i));
            out.appendChild(entry);
        }

        return out;
    }


    function getSelectedGuessCharacter(){
        let out = document.querySelector('input[name="guessCharacter"]:checked');
        if(out == undefined){
            return out;
        }
        return out.value;
    }

    function getSelectedGuessWeapon(){
        let out = document.querySelector('input[name="guessWeapon"]:checked');
        if(out == undefined){
            return out;
        }
        return out.value;
    }

    function getSelectedGuessRoom(){
        let out = document.querySelector('input[name="guessRoom"]:checked');
        if(out == undefined){
            return out;
        }
        return out.value;
    }


    function clearGuessSelection(){
        document.querySelector('input[name="guessCharacter"]:checked').checked = false;
        document.querySelector('input[name="guessWeapon"]:checked').checked = false;
        document.querySelector('input[name="guessRoom"]:checked').checked = false;
    }

    function submitGuess(){
        let askingPlayer = Number.parseInt(document.getElementById("askingPlayerGuess").value) % numberOfPlayers
        let answeringPlayer = Number.parseInt(document.getElementById("answeringPlayerGuess").value) % numberOfPlayers
        let character = getSelectedGuessCharacter();
        let weapon = getSelectedGuessWeapon();
        let room = getSelectedGuessRoom();

        if(character != null && weapon != null && room != null){
            applyGuessResult(askingPlayer, answeringPlayer, new Guess(character, weapon, room))
            updateDataGrid();
        }else{
            throw "Attempted to guess without full selection";
        }
        
        
    }

    function addToYourCards(){
        let character = getSelectedGuessCharacter();
        let weapon = getSelectedGuessWeapon();
        let room = getSelectedGuessRoom();

        if(character != null && validCharacters.includes(character)){
            characterCards[0].set(character, 2);

            for(let i = 1; i < numberOfPlayers; i++){
                characterCards[i].set(character, -1);
            }
        }

        if(weapon != null && validWeapons.includes(weapon)){
            weaponCards[0].set(weapon, 2);

            for(let i = 1; i < numberOfPlayers; i++){
                weaponCards[i].set(weapon, -1);
            }
        }

        if(room != null && validRooms.includes(room)){
            roomCards[0].set(room, 2);

            for(let i = 1; i < numberOfPlayers; i++){
                roomCards[i].set(room, -1);
            }
        }

        updateDataGrid();
    }

    function testFunction(){
        console.log(getSelectedGuessCharacter())
        console.log(getSelectedGuessWeapon())
        console.log(getSelectedGuessRoom())
    }
    updateDataGrid();

    //updateDataGrid();
</script>
</html>